new loader(["/dist/js/jq.js","/dist/js/base.js","/dist/js/myalert.js"],function(t){function e(){var t={count:0,num:0};$(".check.checked:not(.check-all)").each(function(){var e=($(this).parents("tr").data("id"),parseFloat($(this).parents("tr").data("price"),10)),n=~~$(this).parents("tr").find(".number").text();t.num+=n,t.count+=e*n});var e=0;return 1===t.num?e=25:2===t.num?e=100:t.num>=3&&(e=75*t.num),t.count=(100*t.count-100*e)/100,t.benefi=e,console.log(t),$("#cart-count").text(t.count+" 优惠"+e),t}var n=$("#section"),c=($("#submit-btn"),$("#delete-btn"),new Base.template),s={};s=e(),n.on("touchend",".change-number .add",function(t){$(this).siblings(".cut").removeClass("disabled");var n=$(this).siblings(".number");return n.text(~~n.text()+1),s=e(),!1}).on("touchend",".change-number .cut",function(t){var n=$(this).siblings(".number");return n.text(~~n.text()-1),~~n.text()<=1&&(n.text(1),$(this).addClass("disabled")),s=e(),!1}).on("touchend",".check-item",function(t){var n=$(this).find(".check");return n.hasClass("check-all")?(n.hasClass("checked")?$(".check-item .check").removeClass("checked"):$(".check-item .check").addClass("checked"),s=e(),!0):(n.hasClass("checked")?n.removeClass("checked"):n.addClass("checked"),$(".check.checked:not(.check-all)").length===$(".check:not(.check-all)").length?$(".check-item .check").addClass("checked"):$(".check-item .check-all").removeClass("checked"),void(s=e()))}).on("touchend","#submit-btn",function(t){if(!s.num)return void $("body").halokitAlert({content:c.get("confir_dialog",{title:"提示",content:"请选择一个购物车里面的商品"}),closeBtn:".confirm-btn"});var e=[];$(".check.checked:not(.check-all)").each(function(t){e.push({id:$(this).parents("tr").data("id"),count:$(this).parents("tr").find(".number").text()})});var n={name:"halo kit α",carts:e,payment:s.count,benefi:s.benefi};window.location.href="/h5/toPay?scope=snsapi_userinfo&carts="+JSON.stringify(n)}).on("touchend","#delete-btn",function(t){var e=[];$(".check.checked:not(.check-all)").each(function(t){e.push({id:$(this).parents("tr").data("id"),count:$(this).parents("tr").find(".number").text()})}),$.ajax({url:"/h5/cart",type:"POST",contentType:"application/json;charset=utf-8",data:JSON.stringify({carts:e}),success:function(t){t.status?window.location.href="/h5/cart":$("body").halokitAlert({content:c.get("confir_dialog",{title:"提示",content:t.msg}),closeBtn:".confirm-btn"})},error:function(t){$("body").halokitAlert({content:c.get("confir_dialog",{title:"提示",content:"删除购物车失败请重试"}),closeBtn:".confirm-btn"})}})}).on("touchend","#edit-btn",function(t){"编辑"===$(this).text()?($(this).text("选择"),$("#delete-btn").show().removeClass("hidden"),$("#submit-btn").hide()):($(this).text("编辑"),$("#submit-btn").show().removeClass("hidden"),$("#delete-btn").hide())})}).jsLoader();