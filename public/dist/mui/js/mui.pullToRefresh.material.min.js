(function(b){var a=b.className("pull-top-tips");b.PullToRefresh=b.PullToRefresh.extend({init:function(d,c){this._super(d,c);this.options=b.extend(true,{down:{tips:{colors:["008000","d8ad44","d00324","dc00b8","017efc"],size:200,lineWidth:15,duration:1000,tail_duration:1000*2.5}}},this.options);this.options.down.tips.color=this.options.down.tips.colors[0];this.options.down.tips.colors=this.options.down.tips.colors.map(function(e){return{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16)}})},initPullDownTips:function(){var c=this;if(b.isFunction(c.options.down.callback)){c.pullDownTips=(function(){var d=document.querySelector("."+a);if(d){d.parentNode.removeChild(d)}if(!d){d=document.createElement("div");d.classList.add(a);d.innerHTML='<div class="mui-pull-top-wrapper"><div class="mui-pull-top-canvas"><canvas id="pullDownTips" width="'+c.options.down.tips.size+'" height="'+c.options.down.tips.size+'"></canvas></div></div>';d.addEventListener("webkitTransitionEnd",c);document.body.appendChild(d)}c.pullDownCanvas=document.getElementById("pullDownTips");c.pullDownCanvasCtx=c.pullDownCanvas.getContext("2d");c.canvasUtils.init(c.pullDownCanvas,c.options.down.tips);return d}())}},removePullDownTips:function(){this._super();this.canvasUtils.stopSpin()},pulling:function(c){var g=Math.min(c/(this.options.down.height*1.5),1);var h=Math.min(1,g*2);this.pullDownTips.style.webkitTransform="translate3d(0,"+(c<0?0:c)+"px,0)";this.pullDownCanvas.style.opacity=h;this.pullDownCanvas.style.webkitTransform="rotate("+300*g+"deg)";var e=this.pullDownCanvas;var d=this.pullDownCanvasCtx;var f=this.options.down.tips.size;d.lineWidth=this.options.down.tips.lineWidth;d.fillStyle="#"+this.options.down.tips.color;d.strokeStyle="#"+this.options.down.tips.color;d.stroke();d.clearRect(0,0,f,f);e.style.display="none";e.offsetHeight;e.style.display="inherit";this.canvasUtils.drawArcedArrow(d,f/2+0.5,f/2,f/4,0*Math.PI,5/3*Math.PI*h,false,1,2,0.7853981633974483,25,this.options.down.tips.lineWidth,this.options.down.tips.lineWidth)},beforeChangeOffset:function(c){},afterChangeOffset:function(c){},dragEndAfterChangeOffset:function(c){if(c){this.canvasUtils.startSpin();this.pullDownLoading()}else{this.canvasUtils.stopSpin();this.endPullDownToRefresh()}},canvasUtils:(function(){var y=null,v=null,s=200,c=15,A=0,r=0,n=0,o=0,i=0,f=0,e=0,k=180,D=Math.PI/180,d=1000,C=1000*2.5,m=["35ad0e","d8ad44","d00324","dc00b8","017efc"],w=null;function u(H,E,F,G){return F*H/G+E}function q(H,E,F,G){if((H/=G/2)<1){return F/2*H*H+E}return -F/2*((--H)*(H-2)-1)+E}function h(H,F,I){var G=Math.min(F,I);var E=Math.max(F,I);if(H<G){return G}if(H>E){return G}return H}var j=function(S,aa,I,Y,G,V,E,W){if(typeof(aa)=="string"){aa=parseInt(aa)}if(typeof(I)=="string"){I=parseInt(I)}if(typeof(Y)=="string"){Y=parseInt(Y)}if(typeof(G)=="string"){G=parseInt(G)}if(typeof(V)=="string"){V=parseInt(V)}if(typeof(E)=="string"){E=parseInt(E)}var J=3;var N=2*Math.PI;S.save();S.beginPath();S.moveTo(aa,I);S.lineTo(Y,G);S.lineTo(V,E);switch(W){case 0:var ac=Math.sqrt(((V-aa)*(V-aa))+((E-I)*(E-I)));S.arcTo(Y,G,aa,I,0.55*ac);S.fill();break;case 1:S.beginPath();S.moveTo(aa,I);S.lineTo(Y,G);S.lineTo(V,E);S.lineTo(aa,I);S.fill();break;case 2:S.stroke();break;case 3:var M=(aa+Y+V)/3;var K=(I+G+E)/3;S.quadraticCurveTo(M,K,aa,I);S.fill();break;case 4:var Z,X,H,F,ac;var Q=5;if(V==aa){ac=E-I;Z=(Y+aa)/2;H=(Y+aa)/2;X=G+ac/Q;F=G-ac/Q}else{ac=Math.sqrt(((V-aa)*(V-aa))+((E-I)*(E-I)));var T=(aa+V)/2;var L=(I+E)/2;var U=(T+Y)/2;var ab=(L+G)/2;var R=(E-I)/(V-aa);var P=(ac/(2*Math.sqrt(R*R+1)))/Q;var O=R*P;Z=U-P;X=ab-O;H=U+P;F=ab+O}S.bezierCurveTo(Z,X,H,F,aa,I);S.fill();break}S.restore()};var B=function(Q,K,J,O,L,I,F,S,M,T,U,E,R){S=typeof(S)!="undefined"?S:3;M=typeof(M)!="undefined"?M:1;T=typeof(T)!="undefined"?T:Math.PI/8;E=E||1;R=R||10;U=typeof(U)!="undefined"?U:10;Q.save();Q.lineWidth=E;Q.beginPath();Q.arc(K,J,O,L,I,F);Q.stroke();var P,N,V,H,G;if(M&1){P=Math.cos(L)*O+K;N=Math.sin(L)*O+J;V=Math.atan2(K-P,N-J);if(F){H=P+10*Math.cos(V);G=N+10*Math.sin(V)}else{H=P-10*Math.cos(V);G=N-10*Math.sin(V)}g(Q,P,N,H,G,S,2,T,U)}if(M&2){P=Math.cos(I)*O+K;N=Math.sin(I)*O+J;V=Math.atan2(K-P,N-J);if(F){H=P-10*Math.cos(V);G=N-10*Math.sin(V)}else{H=P+10*Math.cos(V);G=N+10*Math.sin(V)}g(Q,P-R*Math.sin(I),N+R*Math.cos(I),H-R*Math.sin(I),G+R*Math.cos(I),S,2,T,U)}Q.restore()};var g=function(P,U,H,S,G,T,N,V,X){if(typeof(U)=="string"){U=parseInt(U)}if(typeof(H)=="string"){H=parseInt(H)}if(typeof(S)=="string"){S=parseInt(S)}if(typeof(G)=="string"){G=parseInt(G)}T=typeof(T)!="undefined"?T:3;N=typeof(N)!="undefined"?N:1;V=typeof(V)!="undefined"?V:Math.PI/8;X=typeof(X)!="undefined"?X:10;var Q=typeof(T)!="function"?j:T;var O=Math.sqrt((S-U)*(S-U)+(G-H)*(G-H));var K=(O-X/3)/O;var M,L,Y,W;if(N&1){M=Math.round(U+(S-U)*K);L=Math.round(H+(G-H)*K)}else{M=S;L=G}if(N&2){Y=U+(S-U)*(1-K);W=H+(G-H)*(1-K)}else{Y=U;W=H}P.beginPath();P.moveTo(Y,W);P.lineTo(M,L);P.stroke();var ab=Math.atan2(G-H,S-U);var R=Math.abs(X/Math.cos(V));if(N&1){var F=ab+Math.PI+V;var J=S+Math.cos(F)*R;var I=G+Math.sin(F)*R;var E=ab+Math.PI-V;var aa=S+Math.cos(E)*R;var Z=G+Math.sin(E)*R;Q(P,J,I,S,G,aa,Z,T)}if(N&2){var F=ab+V;var J=U+Math.cos(F)*R;var I=H+Math.sin(F)*R;var E=ab-V;var aa=U+Math.cos(E)*R;var Z=H+Math.sin(E)*R;Q(P,J,I,U,H,aa,Z,T)}};var t=function(H,G){var L=H%G;if(L<i){m.push(m.shift())}var K=m[0],F=m[1],J=h(u(L,K.r,F.r-K.r,G),K.r,F.r),I=h(u(L,K.g,F.g-K.g,G),K.g,F.g),E=h(u(L,K.b,F.b-K.b,G),K.b,F.b);i=L;return"rgb("+parseInt(J)+","+parseInt(I)+","+parseInt(E)+")"};var p=function(F){var E=F||(new Date).getTime();if(!r){r=E}A=E-r;f=q((A+C/2)%C,0,d,C);e=u((A+f)%d,0,360,d);k=20+Math.abs(u((A+C/2)%C,-300,600,C));v.lineWidth=c;v.lineCap="round";v.strokeStyle=t(A,d);v.clearRect(0,0,s,s);y.style.display="none";y.offsetHeight;y.style.display="inherit";v.beginPath();v.arc(s/2,s/2,s/4,parseInt(e-k)%360*D,parseInt(e)%360*D,false);v.stroke();w=requestAnimationFrame(p)};var x=function(){r=0;i=0;w=requestAnimationFrame(p)};var l=function(){w&&cancelAnimationFrame(w)};var z=function(F,E){y=F;v=y.getContext("2d");var E=b.extend(true,{},E);m=E.colors;d=E.duration;C=E.tail_duration;s=E.size;c=E.lineWidth};return{init:z,drawArcedArrow:B,startSpin:x,stopSpin:l}})()})})(mui);